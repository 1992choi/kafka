# Apache Kafka

<br><br>

## 개념 정리
### 카프카가 데이터 파이프라인으로 적합한 이유
- 높은 처리량
  - 카프카는 프로듀서가 브로커로 데이터를 보낼 때와 컨슈머가 브로커로부터 데이터를 받을 때, 모두 묶어서 전송하고 받는다.
  - 많은 양이 많아지면, 데이터를 송수신할 때 맺어지는 네트워크 비용은 무시할 수 없는 규모가 되는데 네트워크 통신 횟수를 줄일다면 동일 시간 내에 더 많은 데이터를 전송할 수 있다.
  - 파티션 단위를 통해 동일 목적의 데이터를 여러 파티션에 분배하고 데이터를 병렬 처리할 수 있다.
- 확장성
  - 카프카는 가변적인 환경에서 안정적으로 확장 가능하도록 설계되었다.
  - 데이터가 많아지면 클러스터의 브로커 개수를 자연스럽게 늘려 스케일 아웃할 수 있다.
- 영속성
  - 카프카는 다른 메시징 플랫폼과 다르게 데이터를 메모리에 저장하지 않고, 파일 시스템에 저장한다.
  - 파일 시스템을 이용하다보니 느리다고 생각할 수 있겠지만, 파일I/O 성능 향상을 위해 페이지 캐시 영역을 메모리에 따로 생성하여 사용한다.
    - 한 번 읽은 파일 내용은 메모리에 저장시켰다가 다시 사용하는 방식이기 때문에 성능이 향상된다.
  - 파일 시스템을 활용하기 때문에 장애가 발생하여 급작스럽게 종료되더라도 프로세스를 재시작하여 안전하게 데이터를 다시 처리할 수 있다.
- 고가용성
  - 3개 이상의 서버들로 운영되는 카프카 클러스터는 일부 서버에 장애가 발생하더라도 무중단으로 안전하고 지속적인 데이터 처리가 가능하다.

### 카프카 브로커
- ![img.png](img/broker.png)
  - 카프카 브로커는 카프카 클라이언트와 데이터를 주고받기 위해 사용하는 주체이다.
  - 데이터를 분산 저장하여 장애가 발생하더라도 안전하게 사용할 수 있도록 도와주는 애플리케이션이다.
  - 하나의 서버에는 하나의 브로커 프로세스가 실행된다.
  - 카프카 브로커 서버 1대로도 기본 기능이 실행되지만, 안전성을 위하여 3대 이상의 브로커 서버를 사용하고 이를 1개의 클러스터로 묶어 사용하기도 한다.
  - 카프카 클러스터를 실행하기 위해서는 주키퍼가 필요하다.
    - 주키퍼는 브로커들의 상태를 관리하고, 클러스터를 조율하기 위해 사용된다.
  - 카프카 3.0 부터는 주키퍼가 없어도 클러스터 동작이 가능하지만, 아직까지는 정식버전으로 지원하지는 않는다.
